<style>
    #player_chart_div svg g g g g rect { stroke-width:0px; fill:red; }<br />    </style>
<script
  src="https://code.jquery.com/jquery-3.2.1.js"
  integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
  crossorigin="anonymous"></script>
  <script type="text/javascript" src="jquery.ajax-cross-origin.min.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>


<div style="margin-top:10px; text-align:center" >
<button id="getLeagueData">Get data</button>
<input id="leagueId" type="text" />
<div>
<div style="margin-top:10px; text-align:center" >
<button id="getPointHits">Get data</button>
<input id="pointLeagueId" type="text" />
<div>
<div id="player_chart_div"></div>
<div id="points_hit_chart_div"></div>


<script>

var url = 'http://www.game-change.co.uk/proxy.php';

$('#getLeagueData').on('click', function(){
    var leagueId = $('#leagueId').val()
    google.charts.load('current', {packages: ['corechart']});
    google.charts.setOnLoadCallback(drawPlayerChart);


  function drawPlayerChart() {
    var playerChart = new google.visualization.DataTable();
    var leagueLength = 0;

     var options = {
          animation:{
            duration: 1000,
            startup: true,
          },
          hAxis: {
            title: 'Gameweeks',
            
          },
          vAxis: {
            title: 'Score',
            gridlines: true,
          },
          series: {
            1: {curveType: 'function'},
            states: {
                hover: {
                    enabled: true,
                    lineWidth: 5
                }
            },

          },
          'width':'100%',
          'height':800,
          lineWidth: 1,
          legend: { textStyle: {fontSize: 12},
            cursor: 'pointer',
          },
          'curveType': 'function',
          'pointSize': 7,
          'crosshair': {
            trigger: 'none'
          }

        };


    var gw1 = ['Week 1'];
    var gw2 = ['Week 2'];
    var gw3 = ['3'];
    var gw4 = ['4'];
    var gw5 = ['5'];
    var gw6 = ['6'];
    var gw7 = ['7'];
    var gw8 = ['8'];
    var gw9 = ['9'];
    var gw10 = ['10'];
    var gw11= ['11'];
    var gw12 = ['12'];
    var gw13 = ['13'];
    var gw14 = ['14'];
    var gw15 = ['15'];
    var gw16 = ['16'];
    var gw17 = ['17'];
    var gw18 = ['18'];
    var gw19 = ['19'];
    var gw20 = ['20'];
    var gw21 = ['21'];
    var gw22 = ['22'];
    var gw23 = ['23'];
    var gw24 = ['24'];
    var gw25 = ['25'];
    var gw26 = ['26'];
    var gw27 = ['27'];
    var gw28 = ['28'];
    var gw29 = ['29'];
    var gw30 = ['30'];
    var gw31 = ['31'];
    var gw32 = ['32'];
    var gw33 = ['33'];
    var gw34 = ['34'];
    var gw35 = ['35'];
    var gw36 = ['36'];
    var gw37 = ['37'];
    var gw38 = ['38'];

    var playerIds = [];


      $.ajax({
        url:url, data:{csurl:'https://fantasy.premierleague.com/drf/leagues-classic-standings/' + leagueId + '?phase=1'}, 
        success:function(data){
console.log(data);
          //build the chart Y axes
          playerChart.addColumn('string', 'X');

          var players = data.standings.results;
          players.forEach(function(player){
            playerChart.addColumn('number', player.player_name)
            playerIds.push(player.entry);
          })
        }
      }).done(function(){

            $(this).unbind("ajaxStop");
            leagueLength = playerIds.length;
            console.log(leagueLength);

            var fish = $.each(playerIds, function(i, val){

              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/1/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw1.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/2/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw2.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/3/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw3.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/4/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw4.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/5/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw5.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/6/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw6.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/7/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw7.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/8/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw8.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/9/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw9.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/10/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw10.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/11/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw11.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/12/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw12.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/13/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw13.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/14/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw14.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/15/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw15.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/16/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw16.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/17/picks'},
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw17.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/18/picks'},
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw18.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/19/picks'},
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw19.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/20/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw20.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/21/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw21.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/22/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw22.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/23/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw23.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/24/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw24.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/25/picks'},
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw25.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/26/picks'},
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw26.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/27/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw27.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/28/picks'},
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw28.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/29/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw29.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/30/picks'},
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw30.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/31/picks'},
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw31.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/32/picks'},
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw32.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/33/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw33.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/34/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw34.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/35/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw35.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/36/picks'},
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw36.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/37/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw37.push(points)
                    }
                  })
              $.ajax({
                  url:url, data:{csurl:'https://fantasy.premierleague.com/drf/entry/'+val+'/event/38/picks'}, 
                  success:function(data){
                    points = data.entry_history.total_points;
                    gw38.push(points)
                    }
                  })

            })
            
          
      })

      $(document).ajaxStop(function(){
            $(this).unbind("ajaxStop");

              useThese = [];
              allWeeks = [gw1, gw2, gw3, gw4, gw5, gw6, gw7, gw8, gw9, gw10, gw11, gw12, gw13, gw14, gw15, gw16, gw17, gw18, 
                          gw19, gw20, gw21, gw22, gw23, gw24, gw25, gw26, gw27, gw28, gw29, gw30, gw31, gw32, gw33, gw34, gw35,
                          gw36, gw37, gw38];

              for (i=0;i<allWeeks.length;i++){
                if (allWeeks[i].length == leagueLength+1){
                  useThese.push(allWeeks[i]);
                }
              }

              console.log(useThese);

              playerChart.addRows(useThese);
              var chart = new google.visualization.LineChart(document.getElementById('player_chart_div'));
              chart.draw(playerChart, options);

                google.visualization.events.addListener(chart, 'select', function () {
                     
                                });
                })

         
      
    } 

  //the click
})

</script>